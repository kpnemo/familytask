version: 1
frontend:
  phases:
    preBuild:
      commands:
        - echo "=== AMPLIFY BUILD START ==="
        - echo "Node version:" $(node --version)  
        - echo "NPM version:" $(npm --version)
        - echo "=== INSTALLING DEPENDENCIES ==="
        - npm ci
        - echo "=== GENERATING PRISMA CLIENT ==="
        - npx prisma generate
    build:
      commands:
        - echo "=== BUILDING APPLICATION ==="
        - npm run build
        - echo "=== BUILD COMPLETE ==="
  artifacts:
    baseDirectory: .next
    files:
      - '**/*'
  cache:
    paths:
      - node_modules/**/*
      - .next/cache/**/*